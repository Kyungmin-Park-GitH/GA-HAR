# GA-HAR

이 프로젝트는 8x8 적외선(IR) 기반 인간행동인식(HAR) 모델을 NSGA-II 기반 다목적 유전 알고리즘으로 최적화하는 예제 코드입니다. 두 개의 독립적인 데이터세트를 동시에 고려하며, 동일한 신경망 구조 및 하이퍼파라미터 구성을 각 데이터세트에 적용한 뒤 정확도를 계산하여 파레토 최적 개체를 탐색합니다.

## 주요 특징

- **데이터 준비**: CSV 형식의 40 프레임 × 8×8 IR 데이터를 로드하고, 테스트 인덱스 파일을 이용해 학습/테스트 세트를 분리한 뒤 각 프레임에 가우시안 스무딩을 적용하고 학습 세트 평균/표준편차로 정규화합니다.
- **모델 구조**: 입력 40 프레임을 채널로 간주하여 2D 합성곱 신경망을 구성하고, 합성곱층에서 공간 해상도를 유지합니다.
- **평가 전략**: 모든 세대·모든 개체에 대해 5-Fold 교차 검증과 조기 종료를 사용합니다. 각 폴드의 정확도/재현율/정밀도/F1-score를 기록하고 평균값으로 두 데이터세트의 적합도를 계산합니다.
- **세대별 로깅**: 터미널에는 '세대-개체-데이터세트-폴드' 진행 상황이 표시되며, 각 세대의 파레토 우수 50개체(랭크·군집 거리 순)가 확정된 후 폴드별 결과·혼동 행렬·평균 지표가 CSV에 순서대로 기록됩니다.
- **유전 알고리즘**: NSGA-II 절차를 따르며 세대당 50개의 개체를 유지하고 최대 100세대까지 탐색합니다. 각 하이퍼파라미터는 10% 확률로 변이되며, 자식은 3-토너먼트 선택과 50% 균등 교차로 생성됩니다.

## 실행 방법

```bash
python main.py \
    --coventry-path ./data/coventry_2018/40_linear_sensor1 \
    --coventry-test-indices diaz_coventry_108.txt \
    --infra-path ./data/infra_adl2018/40_sensor3 \
    --infra-test-indices diaz_infra_122.txt \
    --generations 100 \
    --population-size 50 \
    --output-dir results
```

인자로 다른 세대 수/개체 수를 전달하더라도 사양에 맞춰 최대 100세대, 세대당 50개체로 강제됩니다.
